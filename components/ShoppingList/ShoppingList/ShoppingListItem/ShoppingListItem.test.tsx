// Wed May 21 14:05:36 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:36 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:35 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:34 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:34 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:33 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:32 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:32 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:31 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:30 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:30 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:29 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:29 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:28 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:27 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:27 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:26 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:26 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:25 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:24 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:23 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:22 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:22 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:21 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:21 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:20 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:20 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:19 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:18 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:18 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:17 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:16 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:16 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:15 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:15 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:14 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:13 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:13 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:12 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:12 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:11 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:10 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:10 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:09 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:09 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:08 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:07 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:07 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:06 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:06 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:05 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:04 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:04 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:03 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:02 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:02 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:01 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:01 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:00 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:05:00 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:59 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:58 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:58 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:57 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:56 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:56 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:55 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:54 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:53 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:53 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:52 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:52 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:51 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:50 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:50 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:49 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:49 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:48 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:47 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:47 2025 +0100 : Basic Implementation of list item

// Wed May 21 14:04:46 2025 +0100 : Basic Implementation of list item


import {render, userEvent} from '@testing-library/react-native';
import ShoppingListItem from './ShoppingListItem';
import type Shopping_List_Item from '@/Types/Shopping_List_Item';
import {useData} from '@/Contexts/DataProvider';

const mockdataContext = {
  deleteShoppingListItem: jest.fn(),
};

jest.mock("@/Contexts/DataProvider", () => {
  return {
    __esModule: true,
    useData: jest.fn(),
  };
});

const onEditMock = jest.fn();

beforeEach(() => {
  jest.resetAllMocks();
  const useDataMock = useData as jest.Mock;
  useDataMock.mockReturnValue(mockdataContext);
});

describe('Shopping List Item renders correctly', () => {
  it('when given all basic item data', () => {
    const testItemData : Shopping_List_Item = {
          Item_ID: 1,
          Item_Name: 'Test Item',
          Item_Quantity: 1
    };


    const {getByText, queryByText} = render(
      <ShoppingListItem
        item={testItemData}
        onEdit={onEditMock}
      />,
    );

    expect(getByText(/Test Item/i)).toBeTruthy();
    expect(getByText(/1g/i)).toBeTruthy();
    expect(queryByText(/Buy By/i)).toBeFalsy();

  });
  it('when given all basic item data and plan data', () => {
    const testItemData : Shopping_List_Item = {
          Item_ID: 1,
          Item_Name: 'Test Item',
          Item_Quantity: 1,
          Plan_Date: new Date('2023-10-01'),
          Item_Recipe_Plan: 1,
          Recipe_Name: 'Test Recipe',
          Item_Recipe_Plan_Ingredient: 1,
    };

    const {getByText} = render(
      <ShoppingListItem
        item={testItemData}
        onEdit={onEditMock}
      />,
    );

    expect(getByText(/Test Item/i)).toBeTruthy();
    expect(getByText(/1g/i)).toBeTruthy();
    expect(getByText(/01\/10\/2023/i)).toBeTruthy();
    expect(getByText(/Test Recipe/i)).toBeTruthy();
  });
});
describe('Shopping List Item calls correctly', () => {
  it("when edit button is pressed", async () => {
    const user = userEvent.setup();
    const testItemData : Shopping_List_Item = {
          Item_ID: 1,
          Item_Name: 'Test Item',
          Item_Quantity: 1
    };

    const {getByText} = render(
      <ShoppingListItem
        item={testItemData}
        onEdit={onEditMock}
      />,
    );

    const editButton = getByText(/Edit/i);

    await user.press(editButton);

    expect(onEditMock).toHaveBeenCalledTimes(1);
    expect(onEditMock).toHaveBeenCalledWith(1);
  })
  it("when delete button is pressed", async () => {

    const user = userEvent.setup();
    const testItemData : Shopping_List_Item = {
          Item_ID: 1,
          Item_Name: 'Test Item',
          Item_Quantity: 1
    };

    const {getByText} = render(
      <ShoppingListItem
        item={testItemData}
        onEdit={onEditMock}
      />,
    );

    const deleteButton = getByText(/Delete/i);

    await user.press(deleteButton);

    expect(mockdataContext.deleteShoppingListItem).toHaveBeenCalledTimes(1);
    expect(mockdataContext.deleteShoppingListItem).toHaveBeenCalledWith(1);
  })
})